For this problem, we are given a pcap file and a server to connect to, in addition to the source code. 
First, we look at the pcap data. Following the TCP stream, we can easily find this message:

```
Welcome to the Thyrin drop box. Please send your public key and message.
Public key: c20a1d8b3903e1864d14a4d1f32ce57e4665fc5683960d2f7c0f30d5d247f5fa264fa66b49e801943ab68be3d9a4b393ae22963888bf145f07101616e62e0db2b04644524516c966d8923acf12af049a1d9d6fe3e786763613ee9b8f541291dcf8f0ac9dccc5d47565ef332d466bc80dc5763f1b1139f14d3c0bae072725815f
Message: 49f573321bdb3ad0a78f0e0c7cd4f4aa2a6d5911c90540ddbbaf067c6aabaccde78c8ff70c5a4abe7d4efa19074a5249b2e6525a0168c0c49535bc993efb7e2c221f4f349a014477d4134f03413fd7241303e634499313034dbb4ac96606faed5de01e784f2706e85bf3e814f5f88027b8aeccf18c928821c9d2d830b5050a1e
```

Now that we know what we're looking for, we can focus on the source code for the server. 
We find a function with some comments that grab our attention fairly quickly.

```python
def make_pool():
  global prime_pool
  # pull our primes out of the cache
  # we used to just generate new ones, but we were running out of randomness too fast.
  # 30 should be plenty
  f = open('primes.txt')
  data = f.read()
  data = data.split('\n')
  data = [int(d) for d in data if d != '']
  for d in data:
    prime_pool.add(d)
  assert len(prime_pool) == 30
```

This tells us that there are only 30 primes that are being used to generate all the private keys. The advantage of RSA lies in that it is difficult to factor large prime numbers. However, it is well known that the `gcd` of two numbers can be calculated in `O(log(n))` time. We can take advantage of this fact!

We could do this intelligently, or we could do this quickly. I opted to do it quickly, and copied over 23 private keys by hand. My guess was that this should hopefully provide us with most of the 30 primes in the text. 

As usual, we write python to solve all our problems. 

```python
def gcd(u, v):
    while v:
        u, v = v, u % v
    return abs(u)
primes = []
x=[]
x.append(int('d839b06b31cb3b695494036fb7f4914f989f3e1428163b59dc7bc73d5287f1cce503544e64fc1a7126568a4c64f5e65a273bc5474e3151d0824c9e8c1fc66d25faa1ec4715ac04f81f7bb9503269312eeb3bb0bd44f079dd54b26c98d34e689764b70bbec404f7198a6ce8446dacb5f56ad014aaf27aa85217bbdad00d07742d',16))
x.append(int('a347029209ca9357d8f61c1831d0fe80363253c4703ede78bd1d81872e7449331fed0ca5c375021e5a1143fa1ed5725984cd0bea0d720e49e010417bda544f6462e6c0d7703904b3a98b4664926edb28c132b1a69b7d176601ac1af75d0f609de5ffc23aab8f3243f86d588398c6a147e4ae2494a3fcaadbb3859f79a53f546d',16))
x.append(int('a6a060fa9b3fd3c4d6e03af3b93e67f367695f48f98a0e6cdaca18a94d93f4e143e194314827ea36ae089ceb0b94fff86b35bd6ace79dabf6b7c24aed1fbd0fdb7c92c1f5c259f29b1e491c6d32b96b96f3656461c70336a89d2040775b72ecf25e5d8285986082616bb74b55e866a6d5de4df7f2225fadf03328d0066d761d1',16))
x.append(int('a5129baf2d15b4b21c4dd10325f352bda52b8402db87e78dab07f44d348207500e542af69e0dde3959ae7024209c75e6ae03fcae12cf8a5845f0bc0456b0c71a4f9cded9979faed3a47d19a5dd7532ab9e28478954f4f4159bf619d95498394c89a0a206cbcee969a37764cd3fea3b9df84ea93ae4027bfc666459efe4a31869',16))
x.append(int('a4e3a25150b9c8c55f404278eab54ce3c40d97c3cb73967496e239f8fe24804b60477b03373a0d851640134bd80d1ff525d64f933f695407f6f25cca5fbe90800690085d4834fec9d03480091799065623112e0ed2df4ff4a94f34103b9fba4470290fa6dd5cb4cf701540090e0d33cf07f63f38f9b3d6e3ee547ea30ea1a0bf',16))
x.append(int('b1d89966b4e656cd32f55231292d1157a38de0e05d1f12035512da25610d4b694f20c1436f14521494656f4262afd25caf9247a9d53acfdefbae0b200b0c0aa6f6d0675ad296f51207ce515cd15c43b44e8ab7df4f7052ec251ed27108a521cc7111c3dcb0426bedd38656d85b4656b83ae9dcec1dae31af3b6868c802fd7737',16))
x.append(int('c4367c1fb920ad80473ca6e096cb06333ef41d5cacda0370d4c9e88be9c6d5aff39e9e7789f972a3a52b9f8338c43fc329c3282f257fba9398af337a751e33883cdf62ede59df197697f0180c8eae28d21f9e3ddd4259b5797942b9420101caa3fbc229629aff2bbf63eb0717e640092dbdd58b5b7703efad659748ff4c522e3',16))
x.append(int('a443b74c595aeb0d072215962b459d2086518945a61466aef6136467d94dbf3f6e45ae9cc969b833a62ee4ea178978961d83f983e151bd79ed6bf251f130f71378dc4e7fca5e6f030a18314288e52b518382a8378decbacaab206ad992e892890231164ae3604b66796dcbb8aa8722964ea61e308c61338c7aad9fc0814a58a9',16))
x.append(int('c50310db5b42bf0ef64b63f8cc16c58e8ed5fd0e18fcfb21d362f15c62a6090d14a293472d4844979238f18aa8d8e771c36e981261721c171401d678c6cf314744c01f734b81ca72b5ec8e26051070672b301a2c89a24affc388cce3ab6cc71afa1f0e107183684cdfc7046e841fcea7da90ca3fd276928292391f06ca07c289',16))
x.append(int('a5f0718c6f290f333aa9d1c7a5442549da3c70cb3302726ac37aedf454b685d67c8ee383ec974d22cbfe6ffa5ed8d865236f4fbf586d3bfc6d621908394d1eff27d2035ef490da52597ee24e5f1ab8a9b176124b32f24aa0c05873bcb6fd0746468fddeee334a5b3a5aa962d869f2e4a8398acd7377607cb3a842ccdb3c061fb',16))
x.append(int('b173613b870cab42fb44ae66458b9d0a1faad73bc541d4a2b0ef64ee99cc97f5434fd95769da52492254097b01fc4dd40168f644573ab6e0f1dddfd312a883604e3ac84ee23cec586a48044d731a9e43e2d76ec4888feb15e287fba12ef2954c881cfb1bd84ab7670790927969458e6363c49d34a0d12afa7aea769418c93c97',16))
x.append(int('c4e99bb797133465963c548bb1deb921b168d8efb6b8b7f0fdc62e085f82041eabc890878744e7e3d4c26921fc726e0d4ff11c9214d07a91be3928608564dcfac15e28f91a012920777a4492a13201533162163a28850aabf4536aa0c79bd94925801869215906394eeecf487e5d63ce3256d36fc3f7b3d43a38ba268928cbbb',16))
x.append(int('9dbd7d4204d55c314a31a9ae4b5c5338b65810a5f10a5d40aa3c7d923fff2ce2113fdfe9a0818a5bcdc04516d9b4c08acaad300cf79158ae68752765303d0514aa05121090c4ab2d0fe38d3bfa319d5bb8ee17549f875ebee5c1e481be657c8f43a554d11d2c42180d1c99e194e1042fd35ee2117da6562f14fa1497c73b689f',16))
x.append(int('db6c263d0816903c1528d4d6595b7f8374c65977298d73eb2732496b1c7f14cc854800476427a3c88bd2b250702c80af33f44fa4146bc5258110f2f7aad6044e2852b24ec8131ea841097b844ca93201b7c3b879c1bd7055c8412a8424dc0ff43dc0ff76e4f4191faeeb916b6a25c6e3fa18da584cb07513375a590301eb8271',16))
x.append(int('d089472d5a4438e0808ec1a9e96c5daf63e4727b9d5585fb39e80768d0709480b88f0fdde29c73aacaafb427511729dbfba2c9b0d2fd3e4d84e15f6f703c1ed1911195ded64f4d6da0c783ce8a182dc363f37c44b0682cee65b1e24557cfc9056305317811f7721d8f38ce1d470a07c37418f35062e19260a84872713f8334cd',16))
x.append(int('e023aede60cec87cd45b326dafddd3fe71fbddafbf664f61779597029504fdd01f8e3e6bd6d7c4133df8df065dd8fc052c77f1368955ef787a4158e8a6adde60b57a43e803915b3612a3ec325b478ecc4f034bae790a992d64245195521ebe3f360a560c9808929f42a97bbd204b99214812c3d559b7a8d41329cbdba7b08fcf',16))
x.append(int('b93facc059981c792470c192732fb5250c6d79176605a277dc78f5c767c5c6a735b7b7b43aafda598356b5a9324ebe77479cee6abae4d03d7ecbf8bf85143e0c7c14e9cce08fb4414ea07ea6695deed0619f09d748c9926476a9eae608eefa21f886c776f2d389ab6bd44cc11f18e4a4eff1de335f30b67e46beeba1f7716a33',16))
x.append(int('b28ae5901c1961d9760bdcbbe10c587fd8073ff6ba7d70f2bfe716c007798c99fd030492c28b347404d2d23475b453978e10c421ea30ca0413db59f6406f13899811c7494c43995f2c676bcdd7ab2a1e5e72551c68edfb8aa5e181ea01bb1331c28b95370cd54c4b408ac187a21839d31888be212fc631f5fe006f893d44be45',16))
x.append(int('df0ac2a415c36d11e07213a095dc5ffe136a3ab7cf1278111018f5769b80dc523acefef8a22d97f89bd85d4926f28a8b1e35b844f25061407522fe2979b9f9fa6d52e24af4be5fddc503b826074ea5ff29a910092fd3bfccf97f69b262d426227e41ad4efb0b786a3199fb1931d1374e30a8e2f87f1a3d552f3e2cb2e2172d8f',16))
x.append(int('aaaab30abbb73870d1fe8bda8af8e2eb2fa8d0e633aee4506d325bfc9ea744a2f9251eb1c4d2aca7978ac9ea5d1f149cd6c61d946a33377061946bf9cb3439179467b9edcd3c9e81651df500373ac740570cdebb9503353dca629e8b1676606129c82e6e85411461e31abae3c02a6de17ea102fe6eea4756cc3a9c2d0a076843',16))
x.append(int('ce74b3f9134925fa19e314e0e11b5585eeb8369bccc695136bf8b5b853e9d4de9c65ee33b134f4f09595fa2f25c32da11e30a083b235b81f09de4d37b7b72deeb03fbac67a2105b1cc78d4dc5cfe6ecf12f3f4a7dec34ed131d2c46276eb174052121400ce78996293f54adab3a67eb63d71faee2b6f311f3e8b33b99ae7ed1d',16))
x.append(int('d32ad85144204f7a7c79e9a23710b67a52b689b0e8c9a25e431084322d3d179b9c4a5ba40710458636ee13b62324c83c74e8f5e251d4cefbcdcc1b82458628a3b311aaee885a80c80b0dfd9d3c987faaa4f7878e958a96917755bf7f749dfc294fcd156840ec8d66a28e138398f45721932c8741d145c45b57a98afa7c957b77',16))
x.append(int('959ba44fb29b3c03328424697bbe9bc8e44faca263802a965e04efad1ee0f1ec8be004ad9b1191e9eaf557f2dce9aac8cac043e6b009b7a64a90ee489d689f349cfa128a2e0233473dc909766c05197889f7054f770ae841408d968dbfa8ce1ba0ff3c4936f3a5cef6075bf31e83a558d6bae4e130d2d80493597da3b77420b1',16))
x.append(int('f50f571994a292b2ba00ee5350544c40d230ffc7e7fe51ab21d39736fdce0cfcf4583ab9a734080ff92498f419068722ec3a978ae62baf7c614878e5d3dc703691e81ef10cbeecda77f610cd420c3b24ca6a2557a5a527c30e6e668ac714181c831e951ff3f948cb9843748de52714b80c34730770d4f9ccc22bdf0e91337ba7',16))

pkey=int('c20a1d8b3903e1864d14a4d1f32ce57e4665fc5683960d2f7c0f30d5d247f5fa264fa66b49e801943ab68be3d9a4b393ae22963888bf145f07101616e62e0db2b04644524516c966d8923acf12af049a1d9d6fe3e786763613ee9b8f541291dcf8f0ac9dccc5d47565ef332d466bc80dc5763f1b1139f14d3c0bae072725815f',16)

f=open('primes.txt','w')
for i in range(0,len(x)):
    for j in range(i+1,len(x)):
        a=gcd(x[i],x[j])
        if a>1 and a<x[i] and a<x[j]:
            p1=x[i]//a
            q1=x[j]//a
            if(a not in primes):
                primes.append(a)
            if(p1 not in primes):
                primes.append(p1)
            if(q1 not in primes):
                primes.append(q1)

print(len(set(primes)))
for i in primes:
    if pkey%i==0:
        print(str(i))
        f.write(str(i)+"\n")
        p=i
        break;
q=pkey//p
f.write(str(q))
f.close()
```

luckily, this lets us find 23 of the 30 primes and successfully factors the private key into `11290942893206290336467162060839444758991526481896862143525109986063294905531141292368885863941910700698869187227122590028398079775349558555477255622057419 * 12068007193924458934136437678747032125702047288192605563386647134926126290032925205587466786811951860570462107503408192389036293790565313661792631609456701`

The server gives us the public exponent to be `65537`. Now all that is left is the simple task of decoding the message itself. This can be done with a little bit of python. 

```python
def extended_gcd(aa, bb):
        lastremainder, remainder = abs(aa), abs(bb)
        x, lastx, y, lasty = 0, 1, 1, 0
        while remainder:
                lastremainder, (quotient, remainder) = remainder, divmod(lastremainder, remainder)
                x, lastx = lastx - quotient*x, x
                y, lasty = lasty - quotient*y, y
        return lastremainder, lastx * (-1 if aa < 0 else 1), lasty * (-1 if bb < 0 else 1)
 
def modinv(a, m):
        g, x, y = extended_gcd(a, m)
    if g != 1:
        raise ValueError
    return x % m
c=int("0x49f573321bdb3ad0a78f0e0c7cd4f4aa2a6d5911c90540ddbbaf067c6aabaccde78c8ff70c5a4abe7d4efa19074a5249b2e6525a0168c0c49535bc993efb7e2c221f4f349a014477d4134f03413fd7241303e634499313034dbb4ac96606faed5de01e784f2706e85bf3e814f5f88027b8aeccf18c928821c9d2d830b5050a1e",16)
N = int("0xc20a1d8b3903e1864d14a4d1f32ce57e4665fc5683960d2f7c0f30d5d247f5fa264fa66b49e801943ab68be3d9a4b393ae22963888bf145f07101616e62e0db2b04644524516c966d8923acf12af049a1d9d6fe3e786763613ee9b8f541291dcf8f0ac9dccc5d47565ef332d466bc80dc5763f1b1139f14d3c0bae072725815f",16)
e = 65537
p=11290942893206290336467162060839444758991526481896862143525109986063294905531141292368885863941910700698869187227122590028398079775349558555477255622057419
q=12068007193924458934136437678747032125702047288192605563386647134926126290032925205587466786811951860570462107503408192389036293790565313661792631609456701
totient = (p-1)*(q-1)
d=modinv(e,totient)
m=pow(c,d,N)
f=open('rsa.txt','w')
f.write(str(hex(m)))
f.close()
```

This gives us the hex string `0x476f6f64207468696e67206e6f206f6e652063616e207265616420746869732120492764206861746520666f72207468656d20746f206b6e6f7720746861742074686520666c6167206973206d616b655f737572655f796f75725f726e675f67656e6572617465735f6c6f7473615f7072696d65732e` 

This, upon converting to ascii, gives us `Good thing no one can read this! I'd hate for them to know that the flag is make_sure_your_rng_generates_lotsa_primes.`

So our flag is: `make_sure_your_rng_generates_lotsa_primes.`